я сделаю авторизацию и профиль ты сделаешь поиск собеседника в кнопке Новый чат
там матчинг через real time database типа скажи ИИ что надо сделать по принципу fifo через realtime
 и очистка очередей с помощью cloud functions типа если юзеры соеденились то удаляем их из очереди и добавляем чат в
 колекцию firestore
 chats (коллекция)
  chatId (документ)
    messages (подколлекция)
      messageId (документ)
        senderId: "user123"
        messageContent: "Hello!"
        timestamp: 1633130533
        messageType: "text"
        isLiked: false  // Индикатор лайка
        isRead: false   // Индикатор прочтения
        isEdited: false // Индикатор изменений
        editedTimestamp: null // Если сообщение было отредактировано
и нужна функция которая будет не по таймеру а вызыватся клиентом:
Если пользователь нажмет на кнопку следующий собеседник то удалится чат из firestore











Архитектура сервиса чат-рулетки
1. Структура данных в RTDB (очередь поиска)
В Realtime Database хранится очередь пользователей со следующими данными:

UID пользователя
Имя
Возраст
Интересы
Пол
Статус: searching (в поиске) или connected (уже подключен)

Логика:

Пользователи со статусом connected исключаются из очереди
Только пользователи со статусом searching участвуют в подборе пары

2. Процесс матчинга
При успешном подключении двух пользователей:

В RTDB создается запись в узле matches с данными обоих пользователей
Статус обоих пользователей меняется на connected
В Firestore создается коллекция для хранения переписки

3. Управление чатами
Сценарий 1: Выход без сохранения

Чат полностью удаляется из Firestore
Запись из matches удаляется из RTDB
Статусы пользователей сбрасываются

Сценарий 2: "Следующий собеседник" без сохранения

Чат удаляется из Firestore
Запись из matches удаляется из RTDB
Пользователь возвращается в очередь со статусом searching

Сценарий 3: Сохранение чата

Чат переносится в постоянное хранилище Firestore (раздел Direct Messages)
Пользователи получают возможность продолжить переписку

4. Серверная архитектура (Cloud Functions)
Функция матчинга:

Управляет очередью пользователей
Создает соединения между пользователями
Создает записи в matches и инициализирует чаты в Firestore

Функция управления чатом:

Обрабатывает сохранение/удаление чатов
Переносит чаты в Direct Messages при необходимости

Клиентская часть:

Пользователи отправляют запросы к Cloud Functions
Управляют своими личными данными (имя, возраст, интересы, пол)


Такая архитектура обеспечивает централизованное управление матчингом через Cloud Functions, минимизируя конфликты и обеспечивая консистентность данных.